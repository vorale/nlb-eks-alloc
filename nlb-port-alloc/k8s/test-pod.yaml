---
# TCP 测试 Pod
apiVersion: v1
kind: Pod
metadata:
  name: game-room-1
  namespace: default
  annotations:
    nlb.port-manager/auto-assign: "true"
    nlb.port-manager/port: "80/TCP"
spec:
  containers:
  - name: game-server
    image: nginx:latest
    ports:
    - containerPort: 80
      protocol: TCP
---
# TCP 测试 Pod 2
apiVersion: v1
kind: Pod
metadata:
  name: game-room-2
  namespace: default
  annotations:
    nlb.port-manager/auto-assign: "true"
    nlb.port-manager/port: "80/TCP"
spec:
  containers:
  - name: game-server
    image: nginx:latest
    ports:
    - containerPort: 80
      protocol: TCP
---
# UDP 测试 Pod
apiVersion: v1
kind: Pod
metadata:
  name: udp-server-1
  namespace: default
  annotations:
    nlb.port-manager/auto-assign: "true"
    nlb.port-manager/port: "5000/UDP"
spec:
  containers:
  - name: udp-server
    image: alpine:latest
    ports:
    - containerPort: 5000
      protocol: UDP
    command: ["/bin/sh", "-c"]
    args:
    - |
      echo "Starting UDP server..."
      while true; do sleep 3600; done
---
# TCP_UDP 双协议测试 Pod
apiVersion: v1
kind: Pod
metadata:
  name: dual-proto-server
  namespace: default
  annotations:
    nlb.port-manager/auto-assign: "true"
    nlb.port-manager/port: "8080/TCP_UDP"
spec:
  containers:
  - name: server
    image: nginx:alpine
    ports:
    - containerPort: 8080
      protocol: TCP
    command: ["/bin/sh", "-c"]
    args:
    - |
      sed -i 's/listen       80;/listen       8080;/' /etc/nginx/conf.d/default.conf
      nginx -g 'daemon off;'
